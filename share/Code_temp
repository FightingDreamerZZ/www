<?php
//zz in index.php
$r=-1;
echo $r;
echo -$r;


$a = array();

$b = array();
$b["id"] = "1";
$b["name"]="haha";
$b["age"]="12";
array_push($a,$b);
$b = array();
$b["id"] = "2";
$b["name"]="heh2";
$b["age"]="6";

array_push($a,$b);
$b = array(
"id"=>"3",
"name"=>"hh",
"age"=>"7"
);
array_push($a,$b);
$b = array(
"id"=>"1",
"name"=>"haa",
"age"=>"11"
);
array_push($a,$b);
$b = array(
"id"=>"4",
"name"=>"ha",
"age"=>"10"
);
array_push($a,$b);
foreach ($a as $k=>$v){
print_r($v);
echo "<br/>";
}
echo "<br/>";
echo "<br/>";
echo "<br/>";
usort($a,function (array $a1, array $b1){
if(($r = $b1["id"]-$a1["id"]) != 0){
return $r;
}
else{
return strcmp($b1["age"],$a1["age"]);
}
});

foreach ($a as $k=>$v){
print_r($v);
echo "<br/>";
}
echo "<br/>";
echo "<br/>";
print_r($b);
//zz

//zz in tran_list.php:
//zz
$array_result_set_after_combine = combine_same_barcode($result_info_1);
$array_result_set_after_sort =
    sort_by_two_fields($array_result_set_after_combine,"quantity", true,"name",true);
?>
<!--    zz-->
    <table>
        <tr>


            <td>Barcode</td>
            <td>Name</td>

            <td>Amount</td>

        </tr>
        <?php
        foreach ($array_result_set_after_sort as $item) {
            ?>
            <tr>


                <td><?php echo $item["barcode"]; ?></td>
                <td><?php echo $item["name"]; ?></td>

                <td><?php echo $item["quantity"]; ?></td>

            </tr>
            <?php
        };
        ?>
    </table>
<!--    zz-->

<?php
//depart.php
//zz test: sendPostRequest("depart.php",{"focus_on":"115127525006","submitbarcode":"whatever"},"POST");

    //depart.php

if($_POST['confirm_decrease']){  //zz decrease是随便起的名字、其实是那个给用户自定义取多少件的小form、这是其handler
    if($_POST['amount'] <= 0){
        stop("Decrease amount must be greater than 0!");
    }
    $barcode = $_POST['barcode'];//zz ?之前post的数据这次post也能也还在吗？--其使用了hidden的input，form常用手法，学起来
    $decrease = -abs($_POST['amount']);
    $decrease_this_time = $decrease;
    $appli = $_POST['appli'];
    $table = get_table($barcode);
    $sql_code = "select * from `".$table."` where barcode = '".$barcode."';";
    $result_info = mysql_query($sql_code);
    $a_check = mysql_fetch_array($result_info);
    if(($a_check[quantity]+cart_amount($_COOKIE['ew_user_name'],$barcode)) < -$decrease){
        stop('Not enough stock!');
    }else{
        if($_GET['application']) {
            cart($_COOKIE['ew_user_name'], $barcode, $decrease, $table, $_GET['application']);//zz 错误的理解、作纪念
        }
        else{
            cart($_COOKIE['ew_user_name'], $barcode, $decrease, $table, "unknown");//zz
        }
    }
    $cart_amount = cart_amount($_COOKIE['ew_user_name'],$barcode);
    $sql_code_a = "SELECT * FROM `ew_relation` WHERE `main_part` = '".$barcode."' ORDER BY `rid` ASC;";
    $result_info_a = mysql_query($sql_code_a);
}

//zz
echo "radio_application!--".$appli."--";

//下面用到的东东（来配合的
?>
<input type="text" style="display:none;" name="appli" id="hidden_input_appli" value = "
            <?php
//                if($appli){echo $appli;}
//                else{echo "Unknown";}
            ?>
            Unknown
        " autocomplete="off"/>

Depart&nbsp;<input type="text" name="amount" value = "<?php if($suggested_decrease){echo $suggested_decrease;}else{echo "0";}?>"
                   class="input_field_w w50" autocomplete="off"/> of this part with an application of
<?php
                if($appli)
                    echo $appli;
                else
                    echo "Unknown";
?>
<a id="lbl_appli">Unknown</a>
? &nbsp;
<input type="submit" class="submit_btn" name="confirm_decrease" value="Confirm"/>

<?php
//login.php:

    //以前的一些实验：
//$path1 = 'lib\sql.php';
//echo "$path1";
//$user = posix_getpwuid(posix_geteuid());
////var_dump($user);
////phpinfo();
//echo ini_get("allow_url_include");
////var_dump(LIB_PATH.DS.'lib\user_lib.php');
///
    ?>
    //depart.php
<script>
    //本来想整这个、后来发现也不对、就算改了cookies，现在页的马上要啊。。要不也得刷新页面一下、触发一下handler
function ajax_sendHttpRequest(path, params, method) {
    var xmlHttp;
    if(window.XMLHttpRequest){
        // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlHttp = new XMLHttpRequest();
    }
    else{// code for IE6, IE5
        xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlHttp.onreadystatechange = function () {
        if(xmlHttp.readyState == 4 && xmlHttp.status == 200){
            //response
        }
    }
        xmlHttp.open(method)
    }
</script>
<?php
//zz
if($_COOKIE['is_to_omit_cart']){
    echo "cookie!cookie=".$_COOKIE['is_to_omit_cart'];
}
if($_COOKIE['is_to_omit_cart']) {
    echo "cookie!cookie=" . $_COOKIE['is_to_omit_cart'];
    ...
}
if($_POST['is_to_omit_cart']){
    $cookie_is_to_omit_cart = $_POST['is_to_omit_cart'];
    setcookie("is_to_omit_cart",$_POST['is_to_omit_cart'],time() + 60*60*2);
    echo "cookie!=post".$_POST['is_to_omit_cart'];
}


echo $ew_verified."<br/>";
echo $pass;


//zz
$the_day_30days_before_today = date("Y-m-d", strtotime("-30 days"));
echo "the_day_30days_before_today".$the_day_30days_before_today;
//zz



        //zz
$result = get_pctg_of_4seasons_of_the_y("2017");
var_dump($result);
//zz

?>

<!--        zz-->
<?php var_dump($array_result_set_after_sort_w_appli);?>

<button value="haha" onclick="hahaha()">ha</button>
<script>
    // define a handler
    function doc_keyUp(e) {

        // this would test for whichever key is 40 and the ctrl key at the same time
        if (e.key == "v") {
            // call your function to do the thing
            alert("haa");
        }
    }
    // register the handler
    document.addEventListener('keyup', doc_keyUp, false);
    function hahaha() {
        alert("hah");
    }
    $(window).keydown(function (e) {
        if(e.key = "v"){
            alert("haa");
        }
    })
    $(document).keyPress(function (e) {
        if(e.key = "v"){
            alert("haa");
        }
    })

</script>

//zz about user type:
// 1->super user(non-admin, but can use all 3 systems warehouse, acc and crm)
// 2->warehouse user (non-admin, can only use warehouse)
// 3->acc user, 4->crm user
// 5->warehouse admin (admin, has some privileges esp warehouse-related such as approve to proceed a cart into system DB)
// Admin->System admin (will use a different system, for user creation and view log etc advanced operation, but no access to normal operation)

<!--    zz notification popup animation part 4/4-->
    <button type="button" id="btntest">haha</button>
    <div id="message"></div>
<!--    -->

/*zz notification popup animation part 3/4*/
    #message {
        position:absolute;
        display:none;
        height:100px;
        width:200px;
        border: 1px gray solid;
        background-color:lime;
        font-size: 1.4em;
        line-height:100px;
        text-align:center;
        border-radius: 5px;
        /*bottom: 100px;*/
    }

        //zz notification popup animation part 1/4
        // "Create a notification popup animated in a specific way?"(http://jsfiddle.net/2qJfF/)
        (function($) {
            $.fn.extend({
                center: function() {
                    return this.each(function() {
                        var left = ($(window).width() - $(this).outerWidth()) / 2;
                        var bottom = ($(window).height() - $(this).outerHeight()) / 4;
                        $(this).css({
                            position: 'absolute',
                            margin: 0,
                            left: (left > 0 ? left : 0) + 'px',
                            bottom: (bottom > 0 ? bottom : 0) + 'px'
                        });
                    });
                }
            });
        })(jQuery);

        //zz notification popup animation part 2/4
        $("#message").center();
        $("#btntest").click(function() {
            var msg = $("#message");
            msg.text("Item saved!")
            msg.hide()
            msg.stop(true, true).fadeIn(500).delay(1000).animate({
                "bottom": "4px",
                "height": "17px",
                "font-size": "1em",
                "left": "80px",
                "line-height": "17px",
                "width": "100px"
            }).fadeOut(5000).css({
                "height": "100px",
                "width": "200px",
                "font-size": "1.4em",
                "line-height": "100px",
                "bottom": "100px"
            }).center();
        });


        <!--    for newly added row from search bar-->
            <?php if($row_3){
                $w_quantity = ($row_3["w_quantity"] =='0')?"n/a":$row_3["w_quantity"];
                echo "<tr>

                        <td><a href='view_part.php?barcode=".$row_3[barcode]."'>
                                ".$row_3[barcode]."
                            </a>
                        </td>
                        <td style='min-width: 150px'>".$row_3["name"]."</td>
                        <td style='max-width: 70px；white-space: normal; word-wrap:break-word'>".$row_3["part_num"]."</td>
                        <td style='max-width: 70px;'
                            id='cell_edit_partnumyigao_".$row_1["barcode"]."'
                            ondblclick='edit_part_num_yigao(".$row_3["barcode"].",".$row_3["part_num_yigao"].")'
                            onblur='changed()'>
                            ".$row_3["part_num_yigao"]."</td>
                        <td>".$row_3["quantity"]."</td>
                        <td>".$w_quantity."</td>


                        <td><input type='checkbox' name='checkbox_".$row_3["barcode"]."' value='checked'/></td>
                        <td><input type='text' name='txt_order_amount_".$row_3["barcode"]."' value =''
                               class='input_field_w w50' autocomplete='off'/></td>
                        <td><input type='text' name='txt_note_".$row_3["barcode"]."' value =''
                               class='input_field_w w50' autocomplete='off'/></td>
                      </tr>";}
            ?>
        <!--    <td>".$row_3["l_zone"]."_".$row_3["l_column"]."_".$row_3["l_level"]."</td>-->


//zz 以下：- search页的smart search功能（乃至所有的smartSearch bar）都有个问题：点击弹出来的ajax链接之后非得先再用这些关键字search一下搜出一条结果然后才能点进去——应能从ajax链接直接进入下个页面
        （他们原本是仍然链去search页的，需要改成链去view_part页）
//for $resultset
//zz <a href="search.php?keyword=xx+yy&table=ew_part">partName partNumber</a>
//            echo "<a href='search.php?keyword=".$url."&table=".$_POST['table']."'>".$row_1["name"]."&nbsp;".$row_1["part_num"]."</a>";

//for $resultset_pn
//            echo "<a href='search.php?keyword=" . $url . "&table=" . $_POST['table'] . "'>" . $row_11["name"] . "&nbsp;" . $row_11["part_num"] . "</a>";

//for $resultset_ac
//zz <a href="search.php?keyword=xx+yy&table=ew_part">partName partNumber</a>
//            echo "<a href='search.php?keyword=" . $url . "&table=" . $_POST['table'] . "'>" . $row_12["name"] . "&nbsp;" . $row_12["part_num"] . "</a>";

//zz 无“special”switch时：
最后一个
<a href="search.php?keyword=<?php echo $url; ?>&table=<?php echo $_POST['table']; ?>">
        <?php echo $row_12["name"]."&nbsp;".$row_12["part_num"]; ?>
    </a>&nbsp;
倒是第二个
<a href="search.php?keyword=<?php echo $url; ?>&table=<?php echo $_POST['table']; ?>">
        <?php echo $row_11["name"]."&nbsp;".$row_11["part_num"]; ?>
    </a>&nbsp;